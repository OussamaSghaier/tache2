<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ReadmeGenerator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Cryptomator Desktop App</a> &gt; <a href="index.source.html" class="el_package">org.cryptomator.ui.addvaultwizard</a> &gt; <span class="el_source">ReadmeGenerator.java</span></div><h1>ReadmeGenerator.java</h1><pre class="source lang-java linenums">package org.cryptomator.ui.addvaultwizard;

import org.jetbrains.annotations.VisibleForTesting;

import javax.inject.Inject;
import java.util.List;
import java.util.ResourceBundle;

@AddVaultWizardScoped
public class ReadmeGenerator {

	// specs: https://web.archive.org/web/20190708132914/http://www.kleinlercher.at/tools/Windows_Protocols/Word2007RTFSpec9.pdf
	private static final String RTF_HEADER = &quot;{\\rtf1\\fbidis\\ansi\\uc0\\fs32\n&quot;;
	private static final String RTF_FOOTER = &quot;}&quot;;
	private static final String HEADING = &quot;\\fs40\\qc %s&quot;;
	private static final String EMPTY_PAR = &quot;&quot;;
	private static final String DONT_PAR = &quot;\\b %s&quot;;
	private static final String IDENT_PAR = &quot;    %s&quot;;
	private static final String HELP_URL = &quot;{\\field{\\*\\fldinst HYPERLINK \&quot;http://docs.cryptomator.org/\&quot;}{\\fldrslt http://docs.cryptomator.org}}&quot;;

	private final ResourceBundle resourceBundle;

	@Inject
<span class="fc" id="L24">	public ReadmeGenerator(ResourceBundle resourceBundle) {</span>
<span class="fc" id="L25">		this.resourceBundle = resourceBundle;</span>
<span class="fc" id="L26">	}</span>

	public String createVaultStorageLocationReadmeRtf() {
<span class="nc" id="L29">		return createDocument(List.of( //</span>
<span class="nc" id="L30">				String.format(HEADING, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.1&quot;)), //</span>
<span class="nc" id="L31">				resourceBundle.getString(&quot;addvault.new.readme.storageLocation.2&quot;), //</span>
				EMPTY_PAR, //
<span class="nc" id="L33">				String.format(DONT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.3&quot;)),  //</span>
<span class="nc" id="L34">				String.format(IDENT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.4&quot;)),  //</span>
<span class="nc" id="L35">				String.format(IDENT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.5&quot;)),  //</span>
				EMPTY_PAR, //
<span class="nc" id="L37">				resourceBundle.getString(&quot;addvault.new.readme.storageLocation.6&quot;),  //</span>
<span class="nc" id="L38">				String.format(IDENT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.7&quot;)),  //</span>
<span class="nc" id="L39">				String.format(IDENT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.8&quot;)),  //</span>
<span class="nc" id="L40">				String.format(IDENT_PAR, resourceBundle.getString(&quot;addvault.new.readme.storageLocation.9&quot;)),  //</span>
				EMPTY_PAR, //
<span class="nc" id="L42">				String.format(resourceBundle.getString(&quot;addvault.new.readme.storageLocation.10&quot;), HELP_URL)  //</span>
		));
	}

	public String createVaultAccessLocationReadmeRtf() {
<span class="nc" id="L47">		return createDocument(List.of( //</span>
<span class="nc" id="L48">				String.format(HEADING, resourceBundle.getString(&quot;addvault.new.readme.accessLocation.1&quot;)), //</span>
<span class="nc" id="L49">				resourceBundle.getString(&quot;addvault.new.readme.accessLocation.2&quot;), //</span>
				EMPTY_PAR, //
<span class="nc" id="L51">				resourceBundle.getString(&quot;addvault.new.readme.accessLocation.3&quot;), //</span>
				EMPTY_PAR, //
<span class="nc" id="L53">				resourceBundle.getString(&quot;addvault.new.readme.accessLocation.4&quot;)));</span>
	}

	@VisibleForTesting
	String createDocument(Iterable&lt;String&gt; paragraphs) {
<span class="fc" id="L58">		StringBuilder sb = new StringBuilder(RTF_HEADER);</span>
<span class="fc bfc" id="L59" title="All 2 branches covered.">		for (String p : paragraphs) {</span>
<span class="fc" id="L60">			sb.append(&quot;{\\sa80 &quot;);</span>
<span class="fc" id="L61">			appendEscaped(sb, p);</span>
<span class="fc" id="L62">			sb.append(&quot;}\\par \n&quot;);</span>
<span class="fc" id="L63">		}</span>
<span class="fc" id="L64">		sb.append(RTF_FOOTER);</span>
<span class="fc" id="L65">		return sb.toString();</span>
	}

	@VisibleForTesting
	String escapeNonAsciiChars(CharSequence input) {
<span class="fc" id="L70">		StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L71">		appendEscaped(sb, input);</span>
<span class="fc" id="L72">		return sb.toString();</span>
	}

	private void appendEscaped(StringBuilder sb, CharSequence input) {
<span class="fc" id="L76">		input.chars().forEachOrdered(c -&gt; {</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">			if (c &lt; 128) {</span>
<span class="fc" id="L78">				sb.append((char) c);</span>
<span class="pc bpc" id="L79" title="1 of 2 branches missed.">			} else if (c &lt; 0xFFFF) {</span>
<span class="fc" id="L80">				sb.append(&quot;\\u&quot;).append(c);</span>
			}
<span class="fc" id="L82">		});</span>
<span class="fc" id="L83">	}</span>


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>